<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DetectorGraph: examples/portuguesetranslator.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DetectorGraph
   &#160;<span id="projectnumber">2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d28a4824dc47e487b107a5db32ef43c4.html">examples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">portuguesetranslator.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A dictionary-based translator that uses shared memory in TopicStates.  
<a href="#details">More...</a></p>

<p><a href="portuguesetranslator_8cpp_source.html">Go to the source code of this file.</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A dictionary-based translator that uses shared memory in TopicStates. </p>
<h1><a class="anchor" id="ex-pt-intro"></a>
Introduction</h1>
<p>This examples implements a very basic translator based only on word replacements.</p>
<h1><a class="anchor" id="ex-pt-sharing-mem"></a>
Using Shared Memory in TopicStates</h1>
<p><a class="el" href="namespaceDetectorGraph.html">DetectorGraph</a> uses C++ copies to propagate information across Topics &amp; Detectors. This is fine &amp; desirable for small amounts of data but can become prohibitive for large objects. In such cases the recommended pattern is to wrap the large resource using an appropriate smart pointer (e.g. std::shared_ptr).</p>
<p>The one caveat is that, as Detectors start accessing shared memory, the <a class="el" href="namespaceDetectorGraph.html">DetectorGraph</a> framework alone cannot guarantee the hermetic nature of detectors - a detector's data (i.e. the data a member pointer points to) may change even though no Evaluate('new value') for that member was called.</p>
<p>In cases where the large data piece only has only read-only use, a const_shared_ptr can be used to partially address the concern mentioned above.</p>
<p>In this example, the <code>TranslationDictionary</code> TopicState carries a large, immutable object and does so using a shared_ptr&lt;const T&gt;: </p><div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">struct </span>TranslationDictionary : <span class="keyword">public</span> TopicState</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    TranslationDictionary()</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    : map(std::make_shared&lt;Text2TextMap&gt;())</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    TranslationDictionary(<span class="keyword">const</span> std::shared_ptr&lt;const Text2TextMap&gt;&amp; aMapPtr)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    : map(aMapPtr)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">bool</span> Lookup(std::string inStr, std::string&amp; outStr)<span class="keyword"> const</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        Text2TextMap::const_iterator lookupIterator = map-&gt;find(inStr);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">if</span> (lookupIterator != map-&gt;end())</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            outStr = lookupIterator-&gt;second;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    };</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    std::shared_ptr&lt;const Text2TextMap&gt; map;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;};</div></div><!-- fragment --><p> A different example that also uses this pattern is <a class="el" href="fancyvendingmachine_8cpp.html">Fancy Vending Machine</a>: </p><div class="fragment"><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keyword">struct </span>ChangeAvailable : <span class="keyword">public</span> <a class="code" href="structDetectorGraph_1_1TopicState.html">DetectorGraph::TopicState</a></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;{</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    ChangeAvailable() : mCoins(), mpChangeLookupTable() {}</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    ChangeAvailable(<span class="keyword">const</span> ChangeAlgo::CoinStock&amp; aCoins, <span class="keyword">const</span> std::shared_ptr&lt;const ChangeAlgo::ChangeLookupTable&gt;&amp; aLookupTable)</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    : mCoins(aCoins)</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    , mpChangeLookupTable(aLookupTable)</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordtype">bool</span> CanGiveChange(<span class="keywordtype">unsigned</span> change)<span class="keyword"> const</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">return</span> mpChangeLookupTable-&gt;CanGiveChange(mCoins, change);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    ChangeAlgo::CoinStock mCoins;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    std::shared_ptr&lt;const ChangeAlgo::ChangeLookupTable&gt; mpChangeLookupTable;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;};</div><div class="ttc" id="structDetectorGraph_1_1TopicState_html"><div class="ttname"><a href="structDetectorGraph_1_1TopicState.html">DetectorGraph::TopicState</a></div><div class="ttdoc">Base struct for topic data types. </div><div class="ttdef"><b>Definition:</b> <a href="topicstate_8hpp_source.html#l00052">topicstate.hpp:52</a></div></div>
</div><!-- fragment --> <h1><a class="anchor" id="ex-pt-arch"></a>
Architecture</h1>
<p>This sample implements the following graph:</p>
<div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_inline_dotgraph_5.svg" width="860" height="131"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe><div class="caption">
TextTranslatorGraph</div>
</div>
 
<p class="definition">Definition in file <a class="el" href="portuguesetranslator_8cpp_source.html">portuguesetranslator.cpp</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
